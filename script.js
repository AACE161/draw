!function t(e,n,r){function i(a,s){if(!n[a]){if(!e[a]){var l="function"==typeof require&&require;if(!s&&l)return l(a,!0);if(o)return o(a,!0);var u=new Error("Cannot find module '"+a+"'");throw u.code="MODULE_NOT_FOUND",u}var c=n[a]={exports:{}};e[a][0].call(c.exports,function(t){var n=e[a][1][t];return i(n?n:t)},c,c.exports,t,e,n,r)}return n[a].exports}for(var o="function"==typeof require&&require,a=0;a<r.length;a++)i(r[a]);return i}({1:[function(t,e,n){var r=t("./possible-groups"),i=t("./util"),o=function(){function t(t){var e=this;this.pots=t,this.groups=[];for(var n=0;n<t[0].length;++n)this.groups.push([]);var r=window.fetch("json/country-names.json").then(function(t){return t.json()}),i=document.createElement("div");i.id="tables-div",this.potsDiv=document.createElement("div"),this.potsDiv.id="pots-div";for(var n=0;n<t.length;++n){var o=t[n],a=document.createElement("table");a.innerHTML="<thead><tr><th>Pot "+(n+1)+"</th></tr></thead><tbody></tbody>";for(var s=a.tBodies[0],l=0;l<o.length;++l){var u=s.insertRow(l).insertCell();u.classList.add("flag"),u.innerHTML=o[l].name,void 0!==o[l].pairing&&(u.title="paired with "+o[l].pairing.name)}this.potsDiv.appendChild(a)}r.then(function(n){for(var r=e.potsDiv.children,i=0;i<r.length;++i)for(var o=e.potsDiv.children[i],a=o.tBodies[0].rows,s=0;s<a.length;++s){var l=a[s].cells[0].style,u=n[t[i][s].country.toLowerCase()].replace(" ","-");l.backgroundImage="url(http://icons.iconarchive.com/icons/gosquared/flag/16/"+u+"-flat-icon.png)"}}),i.appendChild(this.potsDiv),this.groupsDiv=document.createElement("div"),this.groupsDiv.id="groups-div";for(var n=0;n<t[0].length;++n){var a=document.createElement("table");a.innerHTML="<thead><tr><th>Group "+String.fromCharCode(65+n)+"</th></tr></thead><tbody></tbody>";for(var s=a.tBodies[0],l=0;l<t.length;++l)s.insertRow(l).insertCell().classList.add("flag");this.groupsDiv.appendChild(a)}i.appendChild(this.groupsDiv),document.body.appendChild(i);var c=document.createElement("div");c.id="bowls-div",this.teamBowl=document.createElement("div"),this.teamBowl.id="team-bowl",this.teamBowl.classList.add("bowl"),c.appendChild(this.teamBowl),this.announcement=document.createElement("div"),this.announcement.id="announcement",c.appendChild(this.announcement),this.groupBowl=document.createElement("div"),this.groupBowl.id="group-bowl",this.groupBowl.classList.add("bowl"),c.appendChild(this.groupBowl),document.body.appendChild(c),this.currentPotNum=0}return t.prototype.runDraw=function(){if(this.currentPotNum>0||this.groups.some(function(t){return t.length>0})||this.pots.some(function(t){return t.length<8}))throw new Error("cannot start draw");this.fillTeamBowl(),this.announcement.textContent="Pick a ball"},t.prototype.fillTeamBowl=function(){for(var t=this.pots[this.currentPotNum],e=0,n=i.shuffle(t.map(function(t,e){return e}));e<n.length;e++){var r=n[e],o=(t[r],document.createElement("div"));o.classList.add("ball"),o.textContent=t[r].name,o.dataset.team=r.toString(),o.addEventListener("click",this.onTeamBallPick.bind(this)),this.teamBowl.appendChild(o)}},t.prototype.onTeamBallPick=function(t){this.teamBowl.style.cursor="not-allowed",this.teamBowl.style.pointerEvents="none";var e=t.target;e.classList.add("ball-picked");var n=this.pots[this.currentPotNum],o=n.findIndex(function(t){return t.name===e.textContent});this.pickedTeam=n.splice(o,1)[0];for(var a=r["default"](this.pots,this.groups,this.pickedTeam,this.currentPotNum),s=0;s<a.length;s++){var l=a[s],u=i.getCell(this.groupsDiv.children[l],this.currentPotNum);u.classList.add("possible-group")}var c=i.getCell(this.potsDiv.children[this.currentPotNum],parseInt(e.getAttribute("data-team")));c.classList.add("team-selected");var h=a.map(function(t){return String.fromCharCode(65+t)}).join(", ");this.announcement.textContent="Possible groups for "+this.pickedTeam.name+": "+h,this.fillGroupBowl(a)},t.prototype.fillGroupBowl=function(t){for(var e=0,n=i.shuffle(t);e<n.length;e++){var r=n[e],o=document.createElement("div");o.classList.add("ball"),o.textContent=String.fromCharCode(65+r),o.dataset.group=r.toString(),o.addEventListener("click",this.onGroupBallPicked.bind(this)),this.groupBowl.appendChild(o)}},t.prototype.onGroupBallPicked=function(t){var e=parseInt(t.target.dataset.group);this.groups[e].push(this.pickedTeam),this.pickedTeam=null;var n=this.teamBowl.querySelector(".ball-picked");this.teamBowl.removeChild(n);var r=i.getCell(this.groupsDiv.children[e],this.currentPotNum),o=i.getCell(this.potsDiv.children[this.currentPotNum],parseInt(n.getAttribute("data-team")));o.classList.remove("team-selected"),o.classList.add("greyed"),i.animateCell(o,r,300).then(function(){r.classList.remove("possible-group"),r.classList.add("team-emerge")}),this.announcement.textContent="Group "+String.fromCharCode(65+e)+"!",this.groupBowl.innerHTML="",this.teamBowl.style.pointerEvents="auto",this.teamBowl.style.cursor="default",this.teamBowl.onclick=null;for(var a=this.groupsDiv.children,s=0;s<a.length;++s)s!==e&&i.getCell(a[s],this.currentPotNum).classList.remove("possible-group");if(!(this.pots[this.currentPotNum].length>0))if(this.potsDiv.children[this.currentPotNum].tHead.classList.add("greyed"),this.currentPotNum<3)++this.currentPotNum,this.fillTeamBowl(),this.announcement.textContent="Pick a ball";else{var l=this.groupBowl.parentElement;l.removeChild(this.groupBowl),l.removeChild(this.teamBowl),this.announcement.textContent="Draw completed!"}},t}();Object.defineProperty(n,"__esModule",{value:!0}),n["default"]=o},{"./possible-groups":6,"./util":8}],2:[function(t,e,n){function r(t,e){void 0===e&&(e=!0);var n=i(t);return e?n.then(function(t){return o(t)}):n.then(function(t){return a(t)})}function i(t){var e=encodeURIComponent(t);return d("https://proxy-antonv.rhcloud.com/?url="+e+"&encoding=latin1").then(function(t){return t.text()})["catch"](function(e){return d("https://crossorigin.me/"+t).then(function(t){return t.text()}).then(function(t){return h.convertBadName(t)})})["catch"](function(t){return alert("proxies are down")})}function o(t){var e=d("json/pairings.json").then(function(t){return t.json()}),n=s(t);return e.then(function(t){return l(n,t)}).then(function(t){return u(t)})["catch"](function(t){return alert(t.message)})}function a(t){t=t.slice(t.lastIndexOf("--------------"));for(var e,n=[[],[]],r=/\s*(.+?)(\s\*+\d?\s+)?\s{2,}(\w{3})\s+(.+?)(\s\*+\d?\s+)?\s{2,}(\w{3})/g,i=0;8>i&&null!==(e=r.exec(t));++i)n[0].push(new c.Last16Team(e[1],e[3],i)),n[1].push(new c.Last16Team(e[4],e[6],i));return n}function s(t){var e=/\s*(.+?)\s+(\*+\d?\s+)?(\w{3})\s+(\d{1,3}\.\d{3})/g;t=t.slice(t.indexOf("Pot 1"));for(var n,r=[];null!==(n=e.exec(t));)r.push(new c.GSTeam(n[1],n[3],parseFloat(n[4])));return r}function l(t,e){return e.forEach(function(e){var n=e.map(function(e){for(var n=0;n<t.length;n++){var r=t[n];if(r.name.indexOf(e)>-1)return r}throw new Error("couldn't find team named "+e)});n[0].pairing=n[1],n[1].pairing=n[0]}),t}function u(t){var e=["Barcelona","Chelsea","Bayern","Juventus","Benfica","Paris","Zenit","PSV"],n=new Array(4);n[0]=e.map(function(e){for(var n=0;n<t.length;n++){var r=t[n];if(r.name.indexOf(e)>-1)return t.splice(t.indexOf(r),1),r}throw new Error("couldn't find team named "+e)}),t.sort(function(t,e){return e.coefficient-t.coefficient});for(var r=1;r<n.length;++r)n[r]=t.splice(0,8);return n}var c=t("./team"),h=t("./util");"Promise"in window&&"fetch"in window||alert("The draw simulation only works in Chrome, Opera & Firefox.");var d=(window.Promise,window.fetch);Object.defineProperty(n,"__esModule",{value:!0}),n["default"]=r,n.fetchPots=i,n.parseGS=o,n.parseLast16Teams=a},{"./team":7,"./util":8}],3:[function(t,e,n){function r(t,e,n){function r(t,n){var r=e[n],a=r[0],s=o[t];if(s.country===a.country||s.group===a.group)return!1;o.splice(t,1),r.push(s);var l=++n===e.length||i(e,n);return r.pop(),o.splice(t,0,s),l}function i(t,e){var n=t[e],i=o.map(function(t,e){return e});return a.some(function(t,o){var s=a.splice(o,1)[0];n.push(s);var l=i.some(function(t){return r(t,e)});return n.pop(),a.splice(o,0,s),l})}var o=t[0],a=t[1];return o.map(function(t,e){return e}).filter(function(t){return r(t,n)})}Object.defineProperty(n,"__esModule",{value:!0}),n["default"]=r},{}],4:[function(t,e,n){var r=t("./last16"),i=t("./util"),o=function(){function t(t){var e=this;this.pots=t,console.log(t),this.matchups=[];for(var n=0;n<t[0].length;++n)this.matchups.push([]);var r=window.fetch("json/country-names.json").then(function(t){return t.json()}),i=document.createElement("div");i.id="tables-div",i.style.width="400px",i.style.minWidth="400px",this.potsDiv=document.createElement("div"),this.potsDiv.id="pots-div";for(var n=0;n<t.length;++n){var o=t[n],a=document.createElement("table");a.innerHTML="<thead><tr><th>"+["Group winners","Runners-up"][n]+"</th></tr></thead><tbody></tbody>";for(var s=a.tBodies[0],l=0;l<o.length;++l){var u=s.insertRow(l).insertCell();u.classList.add("flag"),u.innerHTML=o[l].name}this.potsDiv.appendChild(a)}r.then(function(n){for(var r=e.potsDiv.children,i=0;i<r.length;++i)for(var o=e.potsDiv.children[i],a=o.tBodies[0].rows,s=0;s<a.length;++s){var l=a[s].cells[0].style,u=n[t[i][s].country.toLowerCase()].replace(" ","-");l.backgroundImage="url(http://icons.iconarchive.com/icons/gosquared/flag/16/"+u+"-flat-icon.png)"}}),i.appendChild(this.potsDiv),this.matchupDiv=document.createElement("div");var c=document.createElement("table");c.innerHTML='<thead><tr><th colspan="3">Matchups</th></tr></thead><tbody></tbody>',c.id="matchups";for(var h=c.tBodies[0],n=0;n<t[0].length;++n){var d=h.insertRow(n),p=d.insertCell();p.classList.add("flag");var m=d.insertCell();m.textContent="v";var f=d.insertCell();f.classList.add("flag")}this.matchupDiv.appendChild(c),i.appendChild(this.matchupDiv),document.body.appendChild(i);var v=document.createElement("div");v.id="bowls-div",this.runnerUpBowl=document.createElement("div"),this.runnerUpBowl.id="team-bowl",this.runnerUpBowl.classList.add("bowl"),v.appendChild(this.runnerUpBowl),this.announcement=document.createElement("div"),this.announcement.id="announcement",v.appendChild(this.announcement),this.groupWinnerBowl=document.createElement("div"),this.groupWinnerBowl.id="group-bowl",this.groupWinnerBowl.classList.add("bowl"),v.appendChild(this.groupWinnerBowl),document.body.appendChild(v),this.currentMatchupNum=0}return t.prototype.runDraw=function(){if(this.currentMatchupNum>0||this.matchups.some(function(t){return t.length>0})||this.pots.some(function(t){return t.length<8}))throw new Error("cannot start draw");this.fillRunnerUpBowl(),this.announcement.textContent="Pick a ball"},t.prototype.fillRunnerUpBowl=function(){for(var t=this.pots[1],e=0,n=i.shuffle(t.map(function(t,e){return e}));e<n.length;e++){var r=n[e],o=(t[r],document.createElement("div"));o.classList.add("ball"),o.textContent=t[r].name,o.dataset.team=r.toString(),o.addEventListener("click",this.onRunnerUpBallPick.bind(this)),this.runnerUpBowl.appendChild(o)}},t.prototype.onRunnerUpBallPick=function(t){var e=this;this.runnerUpBowl.style.cursor="not-allowed",this.runnerUpBowl.style.pointerEvents="none";var n=t.target;n.classList.add("ball-picked");var o=this.pots,a=o[0],s=o[1],l=s.findIndex(function(t){return t.name===n.textContent}),u=s.splice(l,1)[0];console.log(u.name),this.matchups[this.currentMatchupNum].push(u);for(var c=r["default"](this.pots,this.matchups,this.currentMatchupNum),h=c.map(function(t){return a[t].name}),d=0,p=[].map.call(this.potsDiv.firstElementChild.tBodies[0].rows,function(t){return t.cells[0]});d<p.length;d++){var m=p[d];h.indexOf(m.textContent)>-1&&(m.style.color="#00f")}var f=i.getCell(this.potsDiv.lastElementChild,parseInt(n.getAttribute("data-team"))),v=this.matchupDiv.firstElementChild.tBodies[0].rows[this.currentMatchupNum].cells[0];i.animateCell(f,v,300).then(function(){return v.classList.add("team-emerge")}),f.classList.add("greyed");var g=c.map(function(t){return e.pots[0][t].name}).join(", ");this.announcement.textContent="Possible opponents for "+u.name+": "+g,this.fillGroupWinnerBowl(c),this.groupWinnerBowl.style.pointerEvents="auto",this.groupWinnerBowl.style.cursor="default"},t.prototype.fillGroupWinnerBowl=function(t){for(var e=this,n=0,r=i.shuffle(t);n<r.length;n++){var o=r[n],a=document.createElement("div");a.classList.add("ball"),a.textContent=this.pots[0][o].name,a.dataset.team=o.toString(),a.addEventListener("click",this.onGroupWinnerBallPicked.bind(this)),this.groupWinnerBowl.appendChild(a)}1===this.groupWinnerBowl.children.length&&setTimeout(function(){return e.groupWinnerBowl.firstElementChild.click()},200)},t.prototype.onGroupWinnerBallPicked=function(t){var e=this;this.groupWinnerBowl.style.cursor="not-allowed",this.groupWinnerBowl.style.pointerEvents="none";var n=t.target,r=this.pots[0].findIndex(function(t){return t.name===n.textContent}),o=this.pots[0].splice(r,1)[0];this.matchups[this.currentMatchupNum].push(o);for(var a=[].map.call(this.potsDiv.firstElementChild.tBodies[0].rows,function(t){return t.cells[0]}),s=0;s<a.length;s++){var l=a[s];l.style.color=null}var u=a.find(function(t){return t.textContent===o.name}),c=this.matchupDiv.firstElementChild.tBodies[0].rows[this.currentMatchupNum].cells[2];i.animateCell(u,c,300).then(function(){return c.classList.add("team-emerge")}),u.classList.add("greyed");var h=this.runnerUpBowl.querySelector(".ball-picked");if(this.runnerUpBowl.removeChild(h),this.announcement.textContent=o+"!",this.groupWinnerBowl.innerHTML="",this.runnerUpBowl.style.pointerEvents="auto",this.runnerUpBowl.style.cursor="default",this.runnerUpBowl.onclick=null,this.currentMatchupNum<7)++this.currentMatchupNum,this.announcement.textContent="Pick a ball",1===this.runnerUpBowl.children.length&&setTimeout(function(){return e.runnerUpBowl.firstElementChild.click()},200);else{var d=this.groupWinnerBowl.parentElement;d.removeChild(this.groupWinnerBowl),d.removeChild(this.runnerUpBowl),this.potsDiv.classList.add("greyed"),this.announcement.textContent="Draw completed!"}},t}();Object.defineProperty(n,"__esModule",{value:!0}),n["default"]=o},{"./last16":3,"./util":8}],5:[function(t,e,n){var r=t("./fetch-parse-pots"),i=t("./draw-visualizer"),o=t("./last16vis"),a=document.getElementById("gs-link"),s=r.fetchPots("http://kassiesa.home.xs4all.nl/bert/uefa/seedcl2015.html");a.onclick=function(t){document.body.innerHTML="",s.then(function(t){return r.parseGS(t)}).then(function(t){return new i["default"](t).runDraw()})},s.then(function(t){return r.parseLast16Teams(t)}).then(function(t){return new o["default"](t).runDraw()})},{"./draw-visualizer":1,"./fetch-parse-pots":2,"./last16vis":4}],6:[function(t,e,n){function r(t,e,n,r){return e.every(function(t){return 0===t.length})?e.map(function(t,e){return e}):o(e,n,r).filter(function(o){e[o].push(n);var a=i(t,e,r);return e[o].pop(),a})}function i(t,e,n){if(0===t[n].length&&(++n,n===t.length))return!0;for(var r=t[n],a=r.pop(),s=!1,l=0,u=o(e,a,n);l<u.length;l++){var c=u[l],h=e[c];if(h.push(a),s=i(t,e,n),h.pop(),s)break}return r.push(a),s}function o(t,e,n){var r=a(t,e,n,0,t.length>>1),i=a(t,e,n,t.length>>1,t.length);return 0===r.length?i:0===i.length?r:r.concat(i)}function a(t,e,n,r,i){for(var o=[],a=r;i>a;++a){for(var s=t[a],l=!0,u=0;u<s.length;u++){var c=s[u];if(c.country===e.country){if(l=!1,c.pairing===e)return[];break}}l&&s.length<=n&&o.push(a)}return o}Object.defineProperty(n,"__esModule",{value:!0}),n["default"]=r},{}],7:[function(t,e,n){var r=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},i=function(){function t(t,e){this.name=t,this.country=e}return t}(),o=function(t){function e(e,n,r,i){t.call(this,e,n),this.coefficient=r,this.pairing=i}return r(e,t),e}(i);n.GSTeam=o;var a=function(t){function e(e,n,r){t.call(this,e,n),this.group=r}return r(e,t),e}(i);n.Last16Team=a},{}],8:[function(t,e,n){function r(t){for(var e,n,r=t.length;r;e=Math.floor(Math.random()*r),n=t[--r],t[r]=t[e],t[e]=n);return t}function i(t,e){return t.tBodies[0].rows[e].cells[0]}function o(t){return t.replace(/Malm./,"Malmö").replace(/Borussia M.nchengladbach/,"Borussia Mönchengladbach").replace(/Atl.tico/,"Atlético").replace(/Bayern M.nchen/,"Bayern München")}function a(t,e,n){return new window.Promise(function(r){var i=document.createElement("td"),o=i.style;o.opacity=null,o.position="absolute",i.textContent=t.textContent;for(var a=getComputedStyle(t),s=0,l=["width","border","padding","padding-left","background","background-image","background-repeat"];s<l.length;s++){var u=l[s];o[u]=a[u]}var c=t.getBoundingClientRect();o.transform="translate("+c.left+"px, "+c.top+"px)",o.height=c.height-5+"px",o.borderColor="rgba(0,0,0,0)",o.paddingTop="3px",o.backgroundColor=null,document.body.appendChild(i);var h=e.getBoundingClientRect();o.transition="transform "+n+"ms ease-in-out",o.transform="translate3d("+h.left+"px, "+h.top+"px, 0px)",i.addEventListener("transitionend",function(n){document.body.removeChild(i),e.textContent=t.textContent,e.style.backgroundImage=t.style.backgroundImage,r()})})}n.shuffle=r,n.getCell=i,n.convertBadName=o,n.animateCell=a},{}]},{},[5]);